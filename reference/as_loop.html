<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Translate purrr's iterator functions to regular for loops — as_loop • loopurrr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Translate purrr's iterator functions to regular for loops — as_loop"><meta property="og:description" content="as_loop() takes a function call to one of {purrr}'s iterator functions, such as purrr::map(),
and translates it into a regular for loop. Depending on the output context, the translation is
either (i) printed to the console, (ii) copied to the clipboard or (iii) directly inserted into
RStudio. Note that the latter two options require the {clipr} respectively the {rstudioapi}
package to be installed.
The usage is pretty straight-forward: Just wrap a call to a {purrr} iterator function into
as_loop() or us one of the pipe operators (|&amp;gt; or %&amp;gt;%) to pipe the function call into
as_loop(). For details see the examples below."><meta property="og:image" content="https://timteafan.github.io/loopurrr/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">loopurrr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">
    <span class="fas fa-tools"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-clipboard-list"></span>
     
    News
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../reference/index.html">
    <span class="fas fa-tools"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-clipboard-list"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://twitter.com/timteafan" class="external-link">
    <span class="fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/TimTeaFan/loopurrr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Translate purrr's iterator functions to regular for loops</h1>
    <small class="dont-index">Source: <a href="https://github.com/TimTeaFan/loopurrr/blob/HEAD/R/as_loop.R" class="external-link"><code>R/as_loop.R</code></a></small>
    <div class="hidden name"><code>as_loop.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>as_loop()</code> takes a function call to one of <code>{purrr}</code>'s iterator functions, such as <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">purrr::map()</a></code>,
and translates it into a regular <code>for</code> loop. Depending on the output context, the translation is
either (i) printed to the console, (ii) copied to the clipboard or (iii) directly inserted into
RStudio. Note that the latter two options require the <code>{clipr}</code> respectively the <code>{rstudioapi}</code>
package to be installed.</p>
<p>The usage is pretty straight-forward: Just wrap a call to a <code>{purrr}</code> iterator function into
<code>as_loop()</code> or us one of the pipe operators (<code>|&gt;</code> or <code>%&gt;%</code>) to pipe the function call into
<code>as_loop()</code>. For details see the examples below.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">as_loop</span><span class="op">(</span>
  <span class="va">.expr</span>,
  simplify <span class="op">=</span> <span class="cn">TRUE</span>,
  output_nm <span class="op">=</span> <span class="st">"out"</span>,
  idx <span class="op">=</span> <span class="st">"i"</span>,
  output_context <span class="op">=</span> <span class="fu"><a href="output_options.html">default_context</a></span><span class="op">(</span><span class="op">)</span>,
  return <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"string"</span>, <span class="st">"eval"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.expr</dt>
<dd><p>A function call to a <code>{purrr}</code> iterator function. See the "Supported functions"
section below for an overview of which <code>{purrr}</code> iterator functions are currently supported.</p></dd>
<dt>simplify</dt>
<dd><p>When TRUE, the default, <code>as_loop()</code> will run the function call in <code>.expr</code> to
check two things: (1) Whether the call is valid. If not, an error will be thrown, pointing out
that the underlying function call is invalid. (2) Whether the resulting return value contains
<code>NULL</code>. In this case the <code>for</code> loop needs to be more verbose. When <code>simplify</code> is set <code>FALSE</code>
the function call in <code>.expr</code> is not checked for errors and the resulting for loop will be more
verbose even if <code>NULL</code> is not among the return values. It is recommended to set <code>simplify</code> to
<code>FALSE</code> for calculation-heavy function calls.</p></dd>
<dt>output_nm</dt>
<dd><p>sets the name of the resulting output object. The default name is <code>out</code>.</p></dd>
<dt>idx</dt>
<dd><p>sets the name of the index of the for loop. The default index is <code>i</code>.</p></dd>
<dt>output_context</dt>
<dd><p>An optional output context that defines the output target. Possible values
are one or several of:</p><ul><li><p><code>"rstudio"</code>: This will insert the translation to the location where <code>as_loop()</code> was run. If it
was run from within an R script, the for loop will be inserted there, otherwise in the console.
Note that the <code>{rstudioapi}</code> package is required for this option.</p></li>
<li><p><code>"clipboard"</code>: This will copy the for loop translation to the clipboard. Note that the
<code>{clipr}</code> package is required for this option.</p></li>
<li><p><code>"console"</code>: This will print the call to the console using <code><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat()</a></code>.</p></li>
</ul><p>The default setting is to call <code><a href="output_options.html">default_context()</a></code>. This function first looks at the
<code>"loopurrr.output"</code> option. If the option is not specified, then it will default to
<code>c("rstudio", "clipboard", "console")</code>. In this case <code>as_loop()</code> will run the output
options from left to right (starting with <code>"rstudio"</code>) until successful. If neither the
rstudioapi package nor the clipr package are installed, the output context will fall back
to <code>"console"</code>.</p></dd>
<dt>return</dt>
<dd><p>When set to <code>"string"</code>, the default, <code>as_loop()</code> will return the translated code as
character strings to the location specified in <code>output_context</code>. When set to <code>"eval"</code>, the
translated code will be evaluated in a dedicated environment and the output object will be
returned. This option is especially for testing whether <code>as_loop()</code> works as expected. It should
be irrelevant for most users.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Depending on the <code>return</code> argument the return value is:</p><ol><li><p>When <code>output = "string"</code>: <code>NULL</code>. As a side-effect, the translated for loop will be
returned to the specified output context.</p></li>
<li><p>When <code>output = "eval"</code>: Usually the return value of the output object that is constructed
with the for loop. In case of a call to <code>walk</code>, <code>walk2</code> etc. the (first) input object will be
returned.</p></li>
</ol></div>
    <div id="supported-functions">
    <h2>Supported functions</h2>
    


<p>The following iterator functions from the <code>{purrr}</code> package are currently supported:</p><div class="r"><div class="sourceCode"><pre><code><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>
<span class="fu"><a href="../reference/get_supported_fns.html">get_supported_fns</a></span><span class="op">(</span><span class="st">"as_loop"</span><span class="op">)</span>
<span class="co">#&gt; $map</span>
<span class="co">#&gt;  [1] "map"     "map_at"  "map_chr" "map_dbl" "map_df" </span>
<span class="co">#&gt;  [6] "map_dfc" "map_dfr" "map_if"  "map_int" "map_lgl"</span>
<span class="co">#&gt; [11] "map_raw"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $imap</span>
<span class="co">#&gt; [1] "imap"     "imap_chr" "imap_dbl" "imap_dfc" "imap_dfr"</span>
<span class="co">#&gt; [6] "imap_int" "imap_lgl" "imap_raw"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $map</span>
<span class="co">#&gt; [1] "map2"     "map2_chr" "map2_dbl" "map2_df"  "map2_dfc"</span>
<span class="co">#&gt; [6] "map2_dfr" "map2_int" "map2_lgl" "map2_raw"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $pmap</span>
<span class="co">#&gt; [1] "pmap"     "pmap_chr" "pmap_dbl" "pmap_df"  "pmap_dfc"</span>
<span class="co">#&gt; [6] "pmap_dfr" "pmap_int" "pmap_lgl" "pmap_raw"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $lmap</span>
<span class="co">#&gt; [1] "lmap"    "lmap_at"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $modify</span>
<span class="co">#&gt; [1] "modify"    "modify_at" "modify_if" "modify2"  </span>
<span class="co">#&gt; [5] "imodify"  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $walk</span>
<span class="co">#&gt; [1] "iwalk" "pwalk" "walk"  "walk2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $accumulate</span>
<span class="co">#&gt; [1] "accumulate"  "accumulate2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $reduce</span>
<span class="co">#&gt; [1] "reduce"  "reduce2"</span></code></pre></div><p></p></div>
    </div>
    <div id="examples">
    <h2>Examples</h2>
    


<p>If we wrap or pipe a call to <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">purrr::map()</a></code> into <code>as_loop()</code> it will be translated into a
regular for loop. Depending on the output context, the resulting for loop will either be
(i) inserted directly into a script in RStudio, (ii) copied to the clipboard or (iii)
printed to the console.</p><div class="r"><div class="sourceCode"><pre><code><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/as_loop.html">as_loop</a></span><span class="op">(</span><span class="fu">map</span><span class="op">(</span><span class="va">x</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span>        <span class="co"># wrap a call in `as_loop()`</span>
<span class="fu">map</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">sum</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/as_loop.html">as_loop</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># pipe a call into `as_loop()`</span>

<span class="co"># --- convert: `map(x, sum)` as loop --- #</span>
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">out</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>
<span class="co"># --- end loop --- #</span>

<span class="co"># --- end loop --- #</span></code></pre></div><p></p></div>
<p>The <code>output_nm</code> argument lets us specify the name of the resulting output object. In the
example below <code>".res"</code>. The <code>idx</code> argument lets us specify the index to be used. In the example
below <code>"j"</code>.</p><div class="r"><div class="sourceCode"><pre><code><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu">map_dbl</span><span class="op">(</span><span class="va">x</span>, <span class="va">sum</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_loop.html">as_loop</a></span><span class="op">(</span><span class="va">.</span>, output_nm <span class="op">=</span> <span class="st">".res"</span>, idx <span class="op">=</span> <span class="st">"j"</span><span class="op">)</span>

<span class="co"># --- convert: `map_dbl(x, sum)` as loop --- #</span>
<span class="va">.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"double"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">.res</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>
<span class="co"># --- end loop --- #</span></code></pre></div><p></p></div>
<p>When <code>simplify</code> is set <code>FALSE</code> <code>as_loop</code> will neither check the validity of the underlying call
nor the expected output. In this case the resulting <code>for</code> loop is more verbose. This is because we
need to take the case of <code>NULL</code> in the return values into account. In the example below we further
see what happens, when we use an unnamed object, such as <code>1:3</code>, in the call to <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">purrr::map()</a></code>.
<code>as_loop()</code> assign unnamed objects an internal name. In the example below <code>.inp1</code>.</p><div class="r"><div class="sourceCode"><pre><code><span class="fu">map</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">sum</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/as_loop.html">as_loop</a></span><span class="op">(</span><span class="va">.</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># --- convert: `map(1:3, sum)` as loop --- #</span>
<span class="va">.inp1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.inp1</span><span class="op">)</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">.inp1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">.tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">.inp1</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">.tmp</span><span class="op">)</span><span class="op">)</span>
    <span class="va">out</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">.tmp</span>
<span class="op">}</span>
<span class="co"># --- end loop --- #</span></code></pre></div><p></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tim Tiefenbach.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

